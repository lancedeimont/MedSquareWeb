<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <title>MedSquare Web</title> 
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script type="text/javascript" src="http://get.goXTK.com/xtk.js"></script>
        <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css" />
        
        <link rel="stylesheet" href="CSS/main.css">
        <link rel="stylesheet" href="CSS/normalize.css">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script type="text/javascript" src="dat.gui.js"> </script>
        <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
        <script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
    </head>
    <body style="background-color: #000 ">
        <div><button id="butOpen">Open</button></div>
        
        <div style="float: left; width: 30%;height: 100%">
            <div id="axialSlice" style="height:33%; margin: 2px">axial</div>
            <div id="sagitalSlice" style="height:33%; margin: 2px">sagital</div>
            <div id="coronalSlice" style="height:33%; margin: 2px">coronal</div>      
        </div>
        <div class="slice3D" id="3Dslice" style="float:left; width: 50%">            
        </div>
        
        <script> 
            window.onload = function() {

            //
            // try to create the 3D renderer
            //

            _webGLFriendly = true;
            try {
                // try to create and initialize a 3D renderer
                threeD = new X.renderer3D();
                threeD.container = '3d';
                threeD.init();
            } catch (Exception) {

                // no webgl on this machine
                _webGLFriendly = false;

            }
            //
            // create the 2D renderers
            // .. for the X orientation
            sliceX = new X.renderer2D();
            sliceX.container = 'axialSlice';
            sliceX.orientation = 'X';
            sliceX.init();
            // .. for Y
            var sliceY = new X.renderer2D();
            sliceY.container = 'sagitalSlice';
            sliceY.orientation = 'Y';
            sliceY.init();
            // .. and for Z
            var sliceZ = new X.renderer2D();
            sliceZ.container = 'coronalSlice';
            sliceZ.orientation = 'Z';
            sliceZ.init();
            
            //
            // THE VOLUME DATA
            //
            // create a X.volume
            volume = new X.volume();
            volume.file = 'data/sivT1.nii';//'http://x.babymri.org/?vol.nrrd';
            
            sliceX.add(volume);
  
            // start the loading/rendering
            sliceX.render();
  
            //
            // THE GUI
            //
            // the onShowtime method gets executed after all files were fully loaded and
            // just before the first rendering attempt
            sliceX.onShowtime = function() {

                //
                // add the volume to the other 3 renderers
                //
                sliceY.add(volume);
                sliceY.render();
                sliceZ.add(volume);
                sliceZ.render();

                if (_webGLFriendly) {
                  threeD.add(volume);
                  threeD.render();
                }

                // now the real GUI
                var gui = new dat.GUI();

                // the following configures the gui for interacting with the X.volume
                var volumegui = gui.addFolder('Volume');
                // now we can configure controllers which..
                // .. switch between slicing and volume rendering
                var vrController = volumegui.add(volume, 'volumeRendering');
                // .. configure the volume rendering opacity
                var opacityController = volumegui.add(volume, 'opacity', 0, 1);
                // .. and the threshold in the min..max range
                var lowerThresholdController = volumegui.add(volume, 'lowerThreshold',
                    volume.min, volume.max);
                var upperThresholdController = volumegui.add(volume, 'upperThreshold',
                    volume.min, volume.max);
                var lowerWindowController = volumegui.add(volume, 'windowLow', volume.min,
                    volume.max);
                var upperWindowController = volumegui.add(volume, 'windowHigh', volume.min,
                    volume.max);
                // the indexX,Y,Z are the currently displayed slice indices in the range
                // 0..dimensions-1
                var sliceXController = volumegui.add(volume, 'indexX', 0,
                    volume.dimensions[0] - 1);
                var sliceYController = volumegui.add(volume, 'indexY', 0,
                    volume.dimensions[1] - 1);
                var sliceZController = volumegui.add(volume, 'indexZ', 0,
                    volume.dimensions[2] - 1);
                volumegui.open();
            };            
            };
            
            </script>
    </body>
</html>
