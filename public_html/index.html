<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <title>MedSquare Web</title> 
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <!-- using web libraries
        <script type="text/javascript" src="http://get.goXTK.com/xtk.js"></script>
        <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css" />
        <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
        <script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
        -->
        <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css" />
        <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
        <script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
        
        <!--XTK to visualizate medical images, JQuery for the controls -->
        <script type="text/javascript" src="libs/xtk.js"></script>
        <!-- using local libraries (not recommended)
        <link rel="stylesheet" href="jquery-ui.css" />
        <script src="libs/jquery-1.9.1.js"></script>
        <script src="libs/jquery-ui.js"></script> -->
        
        <link rel="stylesheet" href="CSS/main.css">
        <link rel="stylesheet" href="CSS/normalize.css">
        <link rel="stylesheet" href="CSS/mainCss.css">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script type="text/javascript" src="libs/dat.gui.js"> </script>
        
        <!--Qunit to do automatic tests -->
        <link rel="stylesheet" href="qunit-1.11.0.css"> 
        <script src="libs/qunit-1.11.0.js"></script>
        <script src="tests.js"></script>
        
        
        <script>           
            //global variables
            //defines if the browser can use WebGl
            _webGLFriendly = true;
            sessionStorage.setItem("webGL",true);
            volume = new X.volume();
            tst="principal";

            //functions to show the mosaic dialog
            $(function(){
                var rows=$( "#rows" ),
                columns=$( "#columns" ),
                allFields = $( [] ).add( rows ).add( columns );
                $( "#dialog-mosaic" ).dialog({
                  autoOpen: false,
                  height: 330,
                  width: 400,
                  modal: true,
                  buttons: {
                    "Start mosaic mode": function() {
                      var bValid = true;
                      allFields.removeClass( "ui-state-error" );

                      bValid = bValid && checkLength( rows, "rows", 1, 2 );
                      bValid = bValid && checkLength( columns, "columns", 1, 2 );                      

                      bValid = bValid && checkRegexp( rows, /^([0-9]*[1-9][0-9]*)/, "Rows and columns must to be a number different of zero." );
                      // From jquery.validate.js (by joern), contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/
                      bValid = bValid && checkRegexp( columns, /^([0-9]*[1-9][0-9]*)/, "Rows and columns must to be a number different of zero." );                      

                      if ( bValid ) {
                        alert('starting mosaic mode');
                        $( this ).dialog( "close" );
                      }
                    },
                    Cancel: function() {
                      $( this ).dialog( "close" );
                    }
                  },
                  close: function() {
                    allFields.val( "" ).removeClass( "ui-state-error" );
                  }
                });

               function checkLength( o, n, min, max ) {
                  if ( o.val().length > max || o.val().length < min ) {
                    o.addClass( "ui-state-error" );
                    updateTips( "Length of " + n + " must be between " +
                      min + " and " + max + "." );
                    return false;
                  } else {
                    return true;
                  }
                }

                function checkRegexp( o, regexp, n ) {
                  if ( !( regexp.test( o.val() ) ) ) {
                    o.addClass( "ui-state-error" );
                    updateTips( n );
                    return false;
                  } else {
                    return true;
                  }
                }
            });
            
            
            //loads an image saved in the server            
            function loadWebFile(filePath){                
                //volume=new X.volume();
                //volume.file = filePath;                              
                sessionStorage.setItem("volumePath",filePath);
            };
                        
            $(function() {
            $( "#btnOpen" )
              .button()
              .click(function() {
                    loadWebFile('http://x.babymri.org/?vol.nrrd'); 
                    document.getElementById('frVisualiz').contentWindow.showVolume();
              });
            $("#btnMosaic")
                .button()
                .click(function(){
                    $( "#dialog-mosaic" ).dialog( "open" );                     
                });
            $("#btnUpdate")
                .button()
                .click(function(){

                });
            
            });
            
            
        </script>
        
    </head>
    <body style="background-color: #000" >
        <div style="background-color: #ffffff ">
            <img src="images/MedsquareWeb_logo.png">
        </div>
        <div style="background-color: #f0f0f0 ;width:100%">
            <!--<form>
                <input type="button" onclick="xx();" value="Open"/>                
            </form>-->
            <button id="btnOpen">Open</button>
            <button id="btnUpdate">Update</button>
            <button id="btnMosaic">Mosaic Mode</button>
        </div> 
        <div id="dialog-mosaic" title="Mosaic visualization">
        <p class="validateTips">All form fields are required.</p>
        <form>
        <fieldset>
            <label class="image-information-field">
		Rows
            	<input type="text" name="rows" id="rows" class="text ui-widget-content ui-corner-all" />
            </label>
            <label class="image-information-field">
		Columns
            	<input type="text" name="columns" id="columns" value="" class="text ui-widget-content ui-corner-all" />
            </label>
            <label class="image-information-field">
		Gap between slices
            	<input type="text" name="gapping" id="gapping" class="text ui-widget-content ui-corner-all" />
            </label>
        </fieldset>
        </form>
        </div>
        <div id="mainDiv">
            <iframe id="frVisualiz" src="visualization.html" 
                    style="width: 100%; height: 600px">            
        </div>        
        <!-- Divs for tests-->
        <div style="width: 100%; position: absolute; top: 900px">
        <div id="qunit" >         
        </div>
        <div id="qunit-fixture" style="width: 100%"></div>        
    </body>
</html>
